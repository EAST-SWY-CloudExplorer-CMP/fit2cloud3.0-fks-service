<div ng-cloak>
    <md-toolbar class="content-toolbar">
        <div class="md-toolbar-tools">
            <div ng-if = "item.type == 'CREATE'">新建LDAP用户</div>
            <div ng-if = "item.type == 'UPDATE'">编辑LDAP用户</div>
        </div>
    </md-toolbar>
    <form name="addUserForm" class="md-padding">
        <md-input-container class="md-block">
            <label>用户名</label>
            <input autocomplete="new-password" required name="uid" ng-model="item.uid" ng-disabled = "item.type == 'UPDATE'" ng-change="generateMailAndMobile(item.uid)" ng-pattern="/^(1[0-9][0-9])\d{8}$/"/>
            <div ng-messages="addUserForm.uid.$error">
                <div ng-message="required">必填.</div>
                <div ng-message-exp="['required', 'pattern']">
                    用户名为11位的手机号码
                </div>
            </div>
            <div class="hint">登录标识</div>
        </md-input-container>

        <md-input-container class="md-block">
            <label>姓</label>
            <input autocomplete="new-password"  required name="sn" minlength="1" maxlength="50" md-maxlength="50"  ng-model="item.sn" ng-pattern="/^[A-Z]{1}[a-z]*$/"/>
            <div ng-messages="addUserForm.sn.$error">
                <div ng-message="required">必填.</div>
                <div ng-message="md-maxlength">不要超过50个字符</div>
                <div ng-message-exp="['required', 'minlength' , 'pattern' ,  'maxlength']">
                    姓氏为1-50字符内的拼音字母,首字母需大写,例如:Wang
                </div>
            </div>
        </md-input-container>

        <md-input-container class="md-block">
            <label>名</label>
            <input autocomplete="new-password"   name="givenName" minlength="1" maxlength="50" md-maxlength="50"  ng-model="item.givenName" ng-pattern="/^[A-Z]{1}[a-z]*$/"
                   ng-model="item.givenName"/>
            <div ng-messages="addUserForm.givenName.$error">
                <div ng-message="md-maxlength">不要超过50个字符</div>
                <div ng-message-exp="[ 'minlength', 'maxlength', 'pattern']">
                    名为1-50字符内的拼音字母,首字母需大写,例如:Xiaogang
                </div>
            </div>
        </md-input-container>

        <md-input-container class="md-block">
            <label>全名</label>
            <input autocomplete="new-password"  required name="cn" minlength="1" maxlength="100" md-maxlength="100"  ng-model="item.cn" ng-pattern="/^[\u4e00-\u9fa5]+$/"
                   ng-model="item.cn"/>
            <div ng-messages="addUserForm.cn.$error">
                <div ng-message="required">必填.</div>
                <div ng-message="md-maxlength">不要超过100个字符</div>
                <div ng-message-exp="['required', 'minlength', 'maxlength', 'pattern']">
                    全名为中文名字
                </div>
            </div>
        </md-input-container>



        <md-input-container class="md-block">
            <label>邮箱</label>
            <input ng-model="item.mail"  disabled="true" />

<!--            <input autocomplete="new-password" required type="email" name="mail" ng-model="item.mail"-->
<!--                   minlength="5" maxlength="50" md-maxlength="50" ng-pattern="/[\w]@jsnx\.net$/"/>-->

<!--            <div ng-messages="addUserForm.mail.$error" role="alert">-->
<!--                <div ng-message-exp="['required', 'minlength', 'maxlength', 'pattern']">-->
<!--                    邮箱格式仅支持数字字母及下划线后缀皆为@jsnx.net,并且在5-50字符以内-->
<!--                </div>-->
<!--            </div>-->
        </md-input-container>


        <md-input-container class="md-block">
            <label>工号</label>
            <input autocomplete="new-password"  name="employeeNumber" md-maxlength="50" maxlength="50"  ng-model="item.employeeNumber"
                   ng-model="item.employeeNumber"/>
            <div ng-messages="addUserForm.cn.$error">
                <div ng-message="md-maxlength">不要超过50个字符</div>
                <div ng-message-exp="['maxlength']">
                    工号不超过50个字符
                </div>
            </div>
        </md-input-container>

        <md-input-container class="md-block" ng-if = "item.type == 'CREATE'">
            <label>密码</label>
            <i id="eye" class="fa fa-eye f2c-eye" aria-hidden="true" ng-click="view('userPassword','eye')"></i>
            <input autocomplete="new-password" id="userPassword" minlength="6" md-maxlength="30" maxlength="30"
                   type="password"
                   required
                   ng-click="changeType('userPassword')"
                   name="userPassword"
                   ng-model="item.userPassword"
            />

            <div ng-messages="addUserForm.password.$error">
                <div ng-message="required">必填.</div>
                <div ng-message-exp="['required', 'minlength', 'maxlength']">
                    密码必须在6-30字符以内
                </div>
            </div>
        </md-input-container>

        <md-input-container class="md-block" ng-if = "item.type == 'CREATE'">
            <label>确认密码</label>
            <i id="eye1" class="fa fa-eye f2c-eye" aria-hidden="true" ng-click="view('reUserPassword','eye1')"></i>
            <input autocomplete="new-password" id="reUserPassword" md-maxlength="30" type="password" required
                   name="reUserPassword"
                   ng-model="item.rePassword"
                   ng-click="changeType('rePassword')"
                   password-check="item.userPassword">
            <div ng-messages="addUserForm.rePassword.$error">
                <div ng-message="required">必填.</div>
                <div ng-message="passwordCheck">密码不一致.</div>
                <div ng-message="md-maxlength">不要超过30个字符</div>
            </div>
        </md-input-container>

        <md-input-container class="md-block">
            <label>手机号码</label>
            <input ng-model="item.mobile" disabled="true"/>
<!--            <input autocomplete="new-password" name="mobile" ng-model="item.mobile" ng-pattern="/^(1[0-9][0-9])\d{8}$/"/>-->
<!--            <div ng-messages="addUserForm.mobile.$error">-->
<!--                <div ng-message="pattern">请填写正确的手机号码.</div>-->
<!--            </div>-->
        </md-input-container>

        <virtual-select-multiple
                name="groupDns"
                value="dn"
                label="description"
                items="ldapGroups"
                placeholder="选择用户组"
                results="item.groupDns"
        ></virtual-select-multiple>

    </form>
    <div layout="row" layout-align="start center" layout-margin>
        <md-button class="md-raised" ng-click="closeToggleForm()">
            取消
        </md-button>
        <md-button class="md-raised md-primary" ng-disabled="addUserForm.$invalid"
                   ng-click="addLdapUser(item)" ng-if = "item.type == 'CREATE'" >
            保存
        </md-button>
        <md-button class="md-raised md-primary" ng-disabled="addUserForm.$invalid"
                   ng-click="updateLdapUser(item)" ng-if = "item.type == 'UPDATE'" >
            保存
        </md-button>
    </div>
</div>